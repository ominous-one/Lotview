# Lotview Auto Poster (Chrome Extension)

Purpose: Auto-fill Marketplace listings from Lotview inventory using the salesperson's existing Facebook session. Extensible to Kijiji/Craigslist via driver model.

## Structure
- `manifest.json` — MV3 manifest targeting FB Marketplace create listing pages.
- `src/background.ts` — Auth, inventory/templates fetch, logging, message routing.
- `src/content-facebook.ts` — Detects FB create-listing form, fills fields, uploads images.
- `src/popup.tsx` — Login, vehicle picker, template selector, platform selector, trigger fill.
- `src/types.ts` — Shared types.

## API expectations (backend)
- `POST /api/extension/login` → { token, userId, dealershipId, dealershipName }
- `GET /api/extension/inventory?query=` → Vehicle summaries with signed image URLs.
- `GET /api/ad-templates` → Existing template table (filtered by dealership/user).
- `POST /api/extension/postings` → { vehicleId, platform, status, url?, error? }
- `GET /api/extension/limits` (optional) → per-user caps/cooldowns.

## Build (to be wired)
- Use a separate Vite/ESBuild config (not the main app build) to emit:
  - `dist/manifest.json` (copied from root manifest with correct paths)
  - `dist/background.js` (from `src/background.ts`)
  - `dist/content-facebook.js` (from `src/content-facebook.ts`)
  - `dist/popup.js` + `dist/popup.css` + `popup.html`
  - icons in `dist/icons/*`
- See `extension/build.js` placeholder for now; recommend a dedicated `vite.config.extension.ts`.

## Notes
- Stores JWT in extension storage (not in page context).
- Image uploads are prepared in background and passed to content script as Files.
- Per-user FB account cap enforced server-side (max 2 personal accounts).
- Duplicate guard and caps should be enforced via `/api/extension/limits` and posting logs.
